<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>General Self-Efficacy (GSE) — PsycheMetrics</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,500;9..40,700&family=Fraunces:opsz,wght@9..144,400;9..144,700&display=swap" rel="stylesheet">
<script>
tailwind.config = {
  theme: { extend: { fontFamily: { display: ['Fraunces','serif'], body: ['DM Sans','sans-serif'] } } }
}
</script>
<style>
  body { font-family: 'DM Sans', sans-serif; }
  h1,h2,h3 { font-family: 'Fraunces', serif; }
  .fade-in { animation: fadeIn .6s ease-out; }
  .slide-up { animation: slideUp .5s ease-out; }
  @keyframes fadeIn { from{opacity:0} to{opacity:1} }
  @keyframes slideUp { from{opacity:0;transform:translateY(24px)} to{opacity:1;transform:translateY(0)} }
  .option-btn { transition: all .2s ease; }
  .option-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,.08); }
  .option-btn.selected { background: #0d9488; color: white; border-color: #0d9488; }
  .progress-fill { transition: width .4s cubic-bezier(.4,0,.2,1); }
  .gauge-fill { transition: stroke-dashoffset 1.5s cubic-bezier(.4,0,.2,1); }
</style>
</head>
<body class="bg-stone-50 text-gray-800 min-h-screen">

<!-- PsycheMetrics Nav -->
<div class="fixed top-0 left-0 right-0 z-50 bg-white/70 border-b border-stone-200/60" style="backdrop-filter:blur(16px);">
  <div class="max-w-6xl mx-auto px-6 h-12 flex items-center justify-between">
    <a href="index.html" class="flex items-center gap-2 text-sm font-medium text-gray-400 hover:text-gray-900 transition">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7"/></svg>
      Back to PsycheMetrics
    </a>
    <a href="index.html" class="flex items-center gap-2">
      <div class="w-6 h-6 rounded-md bg-gray-900 flex items-center justify-center"><svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg></div>
      <span class="font-bold text-sm text-gray-900" style="font-family:Fraunces,serif">PsycheMetrics</span>
    </a>
  </div>
</div>
<div style="height:48px"></div>

<!-- LANDING -->
<div id="landing" class="min-h-screen flex items-center justify-center px-6 py-12">
  <div class="max-w-2xl w-full fade-in">
    <div class="bg-white shadow-lg rounded-3xl p-10 md:p-14 border border-stone-200/60">
      <div class="flex items-center gap-3 mb-8">
        <div class="w-10 h-10 rounded-xl bg-teal-600 flex items-center justify-center">
          <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
        </div>
        <span class="text-sm font-medium text-teal-600 tracking-wide uppercase">GSE Assessment</span>
      </div>
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-5 leading-tight">General<br>Self-Efficacy Scale</h1>
      <p class="text-gray-500 text-lg leading-relaxed mb-4">
        Measure your belief in your ability to handle challenges, cope with adversity, and adapt to new situations.
      </p>
      <p class="text-gray-400 text-sm mb-8">
        10 questions · ~2 minutes · Developed by Schwarzer & Jerusalem (1995). Validated in 33 languages across 25+ countries.
      </p>
      <button onclick="startQuiz()" class="bg-teal-600 text-white px-8 py-4 rounded-2xl hover:bg-teal-700 transition font-medium text-lg shadow-lg shadow-teal-200">
        Begin Assessment →
      </button>
    </div>
    <p class="text-center text-xs text-gray-400 mt-6">For informational and research purposes. Not a clinical diagnostic tool.</p>
  </div>
</div>

<!-- QUIZ -->
<div id="quiz" class="hidden min-h-screen flex items-center justify-center px-6 py-12">
  <div class="max-w-xl w-full fade-in">
    <div class="bg-white shadow-lg rounded-3xl p-8 md:p-10 border border-stone-200/60">
      <div class="flex items-center justify-between mb-2">
        <span id="progressLabel" class="text-xs font-medium text-gray-400">1 of 10</span>
        <span id="progressPercent" class="text-xs font-medium text-teal-600">10%</span>
      </div>
      <div class="w-full bg-gray-100 rounded-full h-2 mb-8">
        <div id="progressBar" class="progress-fill bg-teal-600 h-2 rounded-full" style="width:10%"></div>
      </div>
      <h2 id="questionText" class="text-xl md:text-2xl font-bold text-gray-900 mb-8 leading-snug"></h2>
      <div id="options" class="grid gap-3"></div>
      <div class="flex justify-between mt-8">
        <button onclick="prevQuestion()" id="prevBtn" class="text-gray-400 hover:text-gray-700 px-4 py-2 rounded-xl transition text-sm font-medium">← Back</button>
        <button onclick="nextQuestion()" id="nextBtn" class="bg-teal-600 text-white px-6 py-2.5 rounded-xl hover:bg-teal-700 transition text-sm font-medium shadow-md">Next →</button>
      </div>
    </div>
  </div>
</div>

<!-- RESULTS -->
<div id="results" class="hidden min-h-screen px-6 py-12">
  <div class="max-w-3xl mx-auto space-y-6">
    <div class="text-center mb-4 slide-up">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">Your Self-Efficacy Profile</h2>
      <p class="text-gray-400 mb-4">Based on the General Self-Efficacy Scale (GSE)</p>
      <div class="no-export flex flex-wrap justify-center items-center gap-3">
        <button onclick="window.print()" class="px-4 py-2 rounded-xl border border-stone-200 text-sm text-gray-700 hover:text-gray-900 hover:border-gray-400 transition">Print / Save PDF</button>
        <button id="copySummaryBtn" onclick="copySummary()" class="px-4 py-2 rounded-xl border border-stone-200 text-sm text-gray-700 hover:text-gray-900 hover:border-gray-400 transition">Copy Summary</button>
      </div>
    </div>

    <!-- Score Gauge -->
    <div id="gaugeSection" class="bg-white shadow-lg rounded-3xl p-8 border border-stone-200/60 slide-up text-center"></div>

    <!-- Bar Chart -->
    <div class="bg-white shadow-lg rounded-3xl p-8 border border-stone-200/60 slide-up">
      <h3 class="text-lg font-bold mb-4 text-gray-700">Item-Level Responses</h3>
      <canvas id="barChart"></canvas>
    </div>

    <!-- Interpretation -->
    <div id="interpretation" class="bg-white shadow-lg rounded-3xl p-8 border border-stone-200/60 slide-up"></div>

    <!-- HR Insights -->
    <div id="hrInsights" class="bg-white shadow-lg rounded-3xl p-8 border border-stone-200/60 slide-up"></div>

    <p class="text-center text-xs text-gray-400 pb-8">Reference: Schwarzer, R., & Jerusalem, M. (1995). International mean = 29.55 (Scholz et al., 2002).</p>
  </div>
</div>

<script>
/* ===================== GSE ITEMS ===================== */
/* All 10 items, 4-point scale, no reverse scoring */
const questions = [
  "I can always manage to solve difficult problems if I try hard enough.",
  "If someone opposes me, I can find the means and ways to get what I want.",
  "It is easy for me to stick to my aims and accomplish my goals.",
  "I am confident that I could deal efficiently with unexpected events.",
  "Thanks to my resourcefulness, I know how to handle unforeseen situations.",
  "I can solve most problems if I invest the necessary effort.",
  "I can remain calm when facing difficulties because I can rely on my coping abilities.",
  "When I am confronted with a problem, I can usually find several solutions.",
  "If I am in trouble, I can usually think of a solution.",
  "I can usually handle whatever comes my way."
];

const likertLabels = ["Not at all true", "Hardly true", "Moderately true", "Exactly true"];

let current = 0;
let answers = new Array(10).fill(null);
let latestResults = null;
let barChartInstance = null;

/* ===================== QUIZ LOGIC ===================== */
function startQuiz() {
  document.getElementById("landing").classList.add("hidden");
  document.getElementById("quiz").classList.remove("hidden");
  renderQuestion();
}

function renderQuestion() {
  document.getElementById("questionText").innerText = `"${questions[current]}"`;
  const pct = Math.round(((current+1)/10)*100);
  document.getElementById("progressLabel").innerText = `${current+1} of 10`;
  document.getElementById("progressPercent").innerText = `${pct}%`;
  document.getElementById("progressBar").style.width = pct+"%";
  document.getElementById("prevBtn").style.visibility = current===0?"hidden":"visible";
  document.getElementById("nextBtn").innerText = current===9?"Calculate Results":"Next →";

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";
  likertLabels.forEach((label,i) => {
    const val = i+1;
    const selected = answers[current]===val;
    const btn = document.createElement("button");
    btn.className = `option-btn w-full text-left px-5 py-3.5 rounded-2xl border-2 font-medium text-sm ${
      selected ? "selected border-teal-600 bg-teal-600 text-white" : "border-gray-200 bg-white text-gray-700 hover:border-teal-300"
    }`;
    btn.innerHTML = `<span class="inline-flex items-center gap-3"><span class="w-6 h-6 rounded-full border-2 ${
      selected?"border-white bg-white/20":"border-gray-300"
    } flex items-center justify-center text-xs font-bold">${selected?"✓":val}</span>${label}</span>`;
    btn.onclick = () => { answers[current]=val; renderQuestion(); };
    optionsDiv.appendChild(btn);
  });
}

function nextQuestion() {
  if(answers[current]===null) return;
  if(current<9) { current++; renderQuestion(); } else { calculateResults(); }
}
function prevQuestion() { if(current>0) { current--; renderQuestion(); } }

/* ===================== SCORING ===================== */
function calculateResults() {
  document.getElementById("quiz").classList.add("hidden");
  document.getElementById("results").classList.remove("hidden");
  window.scrollTo({top:0,behavior:"smooth"});

  // Total score: sum of all items (range 10-40)
  const totalScore = answers.reduce((s,v) => s+v, 0);

  // International norms (Scholz et al., 2002, N=19,719)
  const popMean = 29.55;
  const popSD = 5.28;

  // Z-score and percentile
  const z = (totalScore - popMean) / popSD;
  const percentile = zToPercentile(z);

  latestResults = { totalScore, percentile };
  renderGauge(totalScore, percentile);
  renderBarChart();
  renderInterpretation(totalScore, percentile);
  renderHRInsights(totalScore, percentile);
}

function erf(x) {
  const sign = x>=0?1:-1; x=Math.abs(x);
  const a1=.254829592,a2=-.284496736,a3=1.421413741,a4=-1.453152027,a5=1.061405429,p=.3275911;
  const t=1/(1+p*x);
  return sign*(1-(((((a5*t+a4)*t)+a3)*t+a2)*t+a1)*t*Math.exp(-x*x));
}
function zToPercentile(z) { return Math.min(99,Math.max(1,Math.round((0.5*(1+erf(z/Math.sqrt(2))))*100))); }

/* ===================== GAUGE ===================== */
function renderGauge(score, percentile) {
  let level, levelColor, levelBg;
  if(percentile>=67) { level="High"; levelColor="text-teal-600"; levelBg="bg-teal-50"; }
  else if(percentile>=34) { level="Moderate"; levelColor="text-amber-600"; levelBg="bg-amber-50"; }
  else { level="Low"; levelColor="text-red-500"; levelBg="bg-red-50"; }

  const circumference = 2 * Math.PI * 80;
  const offset = circumference - (percentile/100) * circumference;

  document.getElementById("gaugeSection").innerHTML = `
    <div class="inline-block relative">
      <svg width="200" height="200" class="transform -rotate-90">
        <circle cx="100" cy="100" r="80" fill="none" stroke="#f1f5f9" stroke-width="16"/>
        <circle cx="100" cy="100" r="80" fill="none" stroke="#0d9488" stroke-width="16"
          stroke-linecap="round" stroke-dasharray="${circumference}" stroke-dashoffset="${circumference}"
          class="gauge-fill" style="stroke-dashoffset:${offset}" />
      </svg>
      <div class="absolute inset-0 flex flex-col items-center justify-center">
        <span class="text-4xl font-bold text-gray-900">${score}</span>
        <span class="text-xs text-gray-400">out of 40</span>
      </div>
    </div>
    <div class="mt-4">
      <span class="inline-block px-4 py-1.5 rounded-full ${levelBg} ${levelColor} font-semibold text-sm">${level} Self-Efficacy — ${percentile}th percentile</span>
    </div>
    <p class="text-sm text-gray-400 mt-3">International population mean: 29.55 (Scholz et al., 2002, N=19,719 across 25 countries)</p>
  `;
}

/* ===================== BAR CHART ===================== */
function renderBarChart() {
  const labels = questions.map((q,i) => `Q${i+1}`);
  if(barChartInstance) barChartInstance.destroy();
  barChartInstance = new Chart(document.getElementById("barChart"), {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        label: "Response (1-4)",
        data: answers,
        backgroundColor: answers.map(v => v>=3?"rgba(13,148,136,0.7)":"rgba(245,158,11,0.7)"),
        borderRadius: 6
      }]
    },
    options: {
      responsive: true,
      animation: {duration:1200},
      scales: { y: {min:0, max:4, ticks:{stepSize:1}} },
      plugins: {
        legend: {display:false},
        tooltip: { callbacks: { label: ctx => `${likertLabels[ctx.raw-1]} (${ctx.raw})` } }
      }
    }
  });
}

/* ===================== INTERPRETATION ===================== */
function renderInterpretation(score, percentile) {
  let level, desc;
  if(percentile>=67) {
    level = "High";
    desc = "You have a strong belief in your capacity to handle difficult situations, adapt to challenges, and find solutions when faced with adversity. This level of self-efficacy is associated with greater resilience, proactive coping strategies, and a willingness to take on challenging tasks.";
  } else if(percentile>=34) {
    level = "Moderate";
    desc = "You have a reasonable level of confidence in your ability to cope with challenges, though you may sometimes doubt yourself in particularly unfamiliar or demanding situations. This is a healthy baseline that can be strengthened through experience and skill development.";
  } else {
    level = "Low";
    desc = "You may tend to doubt your ability to handle difficult or novel situations. Lower self-efficacy can be associated with avoidance of challenging tasks and higher stress responses. Building mastery experiences and seeking supportive environments can help strengthen your confidence over time.";
  }

  document.getElementById("interpretation").innerHTML = `
    <h3 class="text-lg font-bold mb-4 text-gray-700">Interpretation</h3>
    <div class="p-4 rounded-2xl bg-teal-50 border border-teal-200 mb-4">
      <p class="font-semibold text-teal-700 mb-2">${level} Self-Efficacy (Score: ${score}/40, ${percentile}th percentile)</p>
      <p class="text-sm text-gray-600 leading-relaxed">${desc}</p>
    </div>
    <div class="text-sm text-gray-500 space-y-2">
      <p><strong>What GSE measures:</strong> Your generalized belief in your competence to handle novel or demanding situations across various domains of life — not situation-specific confidence, but a broad, stable personality resource.</p>
      <p><strong>Key associations:</strong> Higher GSE is linked to greater optimism, work satisfaction, and health outcomes. Lower GSE correlates with higher depression, anxiety, stress, and burnout.</p>
    </div>
  `;
}

/* ===================== HR INSIGHTS ===================== */
function renderHRInsights(score, percentile) {
  let insights = [];
  if(percentile>=67) {
    insights = [
      {title:"Resilience",desc:"Likely to persist through setbacks and recover quickly from failures."},
      {title:"Initiative",desc:"Tends to take on challenging assignments and adapt proactively to change."},
      {title:"Leadership Potential",desc:"Confidence in handling adversity can translate well to leadership roles."},
      {title:"Consideration",desc:"Very high scores should be validated against actual performance to rule out overconfidence."}
    ];
  } else if(percentile>=34) {
    insights = [
      {title:"Steady Performer",desc:"Reliable in familiar domains; may need additional support for novel challenges."},
      {title:"Coaching Opportunity",desc:"Targeted development experiences can boost confidence meaningfully."},
      {title:"Team Fit",desc:"Often works well in collaborative environments with clear guidance."}
    ];
  } else {
    insights = [
      {title:"Support Needed",desc:"May benefit from structured onboarding, mentorship, and gradual challenge escalation."},
      {title:"Skill Building",desc:"Mastery experiences (small wins) are the strongest way to build self-efficacy."},
      {title:"Environment Matters",desc:"A psychologically safe team environment is particularly important."}
    ];
  }

  document.getElementById("hrInsights").innerHTML = `
    <h3 class="text-lg font-bold mb-4 text-gray-700">HR & Workplace Implications</h3>
    <div class="grid gap-3">
      ${insights.map(i => `<div class="p-3 rounded-xl bg-gray-50 border border-gray-200">
        <p class="font-semibold text-gray-700 text-sm">${i.title}</p>
        <p class="text-xs text-gray-500 mt-1">${i.desc}</p>
      </div>`).join("")}
    </div>
    <p class="text-xs text-gray-400 mt-4">Self-efficacy is malleable. Bandura (1977) identified four sources: mastery experiences, vicarious learning, verbal persuasion, and physiological states.</p>
  `;
}

function copySummary() {
  if(!latestResults) return;
  const summary = `Total score: ${latestResults.totalScore}/40\nPercentile: ${latestResults.percentile}th`;
  navigator.clipboard.writeText(`PsycheMetrics GSE Summary\n${summary}`).then(() => {
    const btn = document.getElementById('copySummaryBtn');
    if(!btn) return;
    const orig = btn.textContent;
    btn.textContent='Copied';
    setTimeout(()=>btn.textContent=orig,1200);
  });
}


</script>
</body>
</html>
